


                ( S.R.ATHUL JAISHANKAR )  QUIZ 7 - SQL 


--1A
CREATE VIEW MAINE_TRIPS AS 
SELECT TRIP_ID , TRIP_NAME , START_LOCATION , DISTANCE , MAX_GRP_SIZE , 
TYPE , SEASON 
FROM Col_TRIP
WHERE STATE='ME'

--1B
SELECT TRIP_ID , TRIP_NAME , DISTANCE 
FROM MAINE_TRIPS

--1C 
SELECT TRIP_ID , TRIP_NAME , DISTANCE 
FROM col_trip where state = 'me'

--1D
--  NO , UPDATING THE DATABASE THROUGH MAINE_TRIPS DOESN'T CREATE ANY PROBLEMS 
--     BECAUSE MAINE_TRIPS VIEW DOES NOT CONTAIN ANY JOIN FUNCTIONS . 


--2A 
CREATE VIEW RESERVATION_CUSTOMER AS
SELECT A.RESERVATION_ID , TRIP_ID , TRIP_DATE , B.CUSTOMER_NUM , 
LAST_NAME , FIRST_NAME , PHONE 
FROM Col_RESERVATION A , Col_CUSTOMER B 
WHERE A.CUSTOMER_NUM=B.CUSTOMER_NUM

--2B
SELECT RESERVATION_ID , TRIP_ID , TRIP_DATE , LAST_NAME
FROM RESERVATION_CUSTOMER
WHERE TRIP_DATE = '2016-09-11'

--2C
SELECT A.RESERVATION_ID , TRIP_ID , TRIP_DATE , B.LAST_NAME
FROM Col_RESERVATION A , Col_CUSTOMER B 
WHERE A.CUSTOMER_NUM=B.CUSTOMER_NUM
AND TRIP_DATE='2016-09-11'

--2D 
--    YES , UPDATING THE DATABASE THROUGH VIEW CREATE PROBLEMS BECAUSE THIS VIEW INVOLVES JOINS OF OTHER TABLE 
--    OTHER THAN PRIMARY KEY , YOU CANNOT UPDATE THE DATABASE THROUGH THIS VIEW 


--3A 
CREATE VIEW TRIP_INVENTORY AS 
SELECT STATE , COUNT(STATE) AS UNITS 
FROM Col_TRIP
GROUP BY STATE 

--3B
SELECT STATE , UNITS 
FROM TRIP_INVENTORY 
WHERE UNITS >=10

--3C
SELECT STATE ,COUNT(STATE) AS UNITS 
FROM Col_TRIP 
GROUP BY STATE
HAVING COUNT(STATE)>10

--3D 
--  NO , UPDATING THE DATABASE THROUGH TRIP_INVENTORY DOESN'T CREATE ANY PROBLEMS 
--     BECAUSE TRIP_INVENTORY VIEW DOES NOT CONTAIN ANY JOIN FUNCTIONS . 

--6A 
CREATE INDEX TRIP_INDEX1 ON COL_TRIP(TRIP_NAME)

--6B 
CREATE INDEX TRIP_INDEX2 ON COL_TRIP(TYPE)

--6C
CREATE INDEX TRIP_INDEX3 ON COL_CUSTOMER(FIRST_NAME , LAST_NAME)

--7
DROP INDEX TRIP_INDEX3 ON COL_CUSTOMER 

--9
ALTER TABLE COL_RESERVATION 
ADD FOREIGN KEY(CUSTOMER_NUM) 
REFERENCES COL_CUSTOMER 

